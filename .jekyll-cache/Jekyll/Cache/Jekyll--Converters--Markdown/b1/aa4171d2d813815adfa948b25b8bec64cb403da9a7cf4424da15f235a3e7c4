I"[Š<hr />

<p>ä»Šå¤©çš„åšå®¢æ›´çš„æœ‰äº›æ™šï¼Œæ²¡æœ‰åŠæ³•ï¼Œæ™šä¸Šä¸€åœºcfï¼Œç™½å¤©åˆè‡ªé—­ï¼Œç›´æ¥é¸½æ‰äº†ï¼Œå˜¤å˜¤å˜¤ã€‚</p>

<h2 id="a-è¿·å®«">A è¿·å®«</h2>

<p>çœ‹äº†å¤§ä½¬ä»¬çš„åšå®¢æ„Ÿè§‰å¥½åƒæ˜ç™½äº†äºæ˜Šçš„åšæ³•</p>

<p>å…ˆbfsæœå‡ºæœ€å¤§çš„æ·±åº¦å’Œæ¯ä¸€å±‚ç‚¹çš„ä¸ªæ•°</p>

<p>æ¯ä¸€å±‚åªè¦æœ‰ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„ç‚¹å°±ä¼šä½¿è¿™äº›äººåœ¨æŸä¸€ç‚¹å†²çªï¼Œä¼šå¤šèµ°äººæ•°å‡1æ­¥ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰ç‚¹å°±å¯ä»¥å°‘èµ°ä¸€æ­¥ï¼Œå¦‚æœå¤šèµ°çš„æ­¥æ•°ä¸º0ï¼Œåˆ™ä¸éœ€è¦å°‘èµ°ã€‚</p>

<p>ä¹‹åå°±å¯ä»¥æŒ‰æ¯ä¸ªç‚¹éƒ½å¯ä»¥è£…ä¸‹æ— é™ä¸ªæ•°çš„äººæ¥è®¡ç®—ï¼Œæ•´ä¸ªå›¾ç•…é€šï¼Œä¸ä¼šå µä½ï¼Œè®¡ç®—æ­¥æ•°ï¼Œä¹Ÿå°±æ˜¯æœ€æ·±çš„ç‚¹çš„æ·±åº¦ã€‚</p>

<p>å¤šèµ°çš„æ­¥æ•°åŠ ä¸Šä¸å¤šèµ°æ—¶éœ€è¦çš„æ­¥æ•°å°±æ˜¯ç­”æ¡ˆã€‚</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;bits/stdc++.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">to</span><span class="p">[</span><span class="mi">200010</span><span class="p">],</span><span class="n">ne</span><span class="p">[</span><span class="mi">200010</span><span class="p">],</span><span class="n">fi</span><span class="p">[</span><span class="mi">200010</span><span class="p">],</span><span class="n">tot</span><span class="p">,</span><span class="n">mm</span><span class="p">,</span><span class="n">nn</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="mi">100001</span><span class="p">],</span><span class="n">d</span><span class="p">[</span><span class="mi">100001</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">100001</span><span class="p">],</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">,</span><span class="n">mark</span><span class="p">[</span><span class="mi">100001</span><span class="p">],</span><span class="n">dmax</span><span class="p">,</span><span class="n">ans</span><span class="p">;</span>
<span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">;</span>
<span class="c1">//mark[i] è¡¨ç¤ºæ·±åº¦ä¸ºiçš„èŠ‚ç‚¹ä¸­1çš„ä¸ªæ•°ï¼›d[i]è¡¨ç¤ºièŠ‚ç‚¹çš„æ·±åº¦ï¼› </span>
<span class="kt">int</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">y</span><span class="p">){</span>
    <span class="n">to</span><span class="p">[</span><span class="o">++</span><span class="n">tot</span><span class="p">]</span><span class="o">=</span><span class="n">y</span><span class="p">;</span>
    <span class="n">ne</span><span class="p">[</span><span class="n">tot</span><span class="p">]</span><span class="o">=</span><span class="n">fi</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
    <span class="n">fi</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">tot</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n1</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n2</span><span class="p">);</span>
        <span class="n">add</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="p">);</span>
        <span class="n">add</span><span class="p">(</span><span class="n">n2</span><span class="p">,</span><span class="n">n1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
        <span class="n">q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">fi</span><span class="p">[</span><span class="n">x</span><span class="p">];</span><span class="n">i</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="n">ne</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">y</span><span class="o">=</span><span class="n">to</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">]){</span>
                <span class="n">q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
                <span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">y</span><span class="p">]){</span>
                    <span class="n">mark</span><span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
                    <span class="n">dmax</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">dmax</span><span class="p">,</span><span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">]);</span>
                <span class="p">}</span>
                <span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">dmax</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ans</span><span class="o">+=</span><span class="n">mark</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">ans</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">ans</span><span class="o">+=</span><span class="n">dmax</span><span class="p">;</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="b-é‡æ–°å®šä¹‰å­—å…¸åº">B é‡æ–°å®šä¹‰å­—å…¸åº</h2>

<p>è€ƒè™‘æšä¸¾ <strong>k</strong>ï¼Œä½¿å¾— A,B çš„ç¬¬ <strong>p[1],p[2]â€¦p[k-1]</strong> å°éƒ½ç›¸ç­‰ï¼Œä½† æ˜¯ B çš„ç¬¬ <strong>p[k]</strong> å°æ¯” A çš„ç¬¬ <strong>p[k]</strong> å°è¦å°</p>

<p>å¯ä»¥æšä¸¾ B çš„ç¬¬ <strong>p[k]</strong> å°çš„å€¼ï¼Œè¿™æ ·æ˜¯ <strong>n^2</strong> çš„</p>

<p>åˆ†æƒ…å†µæšä¸¾å¯ä»¥åšåˆ° nlogn</p>

<h2 id="c-æ–æ³¢é‚£å¥‘æ•°åˆ—">C æ–æ³¢é‚£å¥‘æ•°åˆ—</h2>

<p><strong>F[n]&amp;(F[n]-1)=F[n]-lowbit(F[n])</strong></p>

<p>è€Œåªæœ‰ n æ˜¯ 3 çš„å€æ•°æ—¶ï¼Œ<strong>F[n]</strong> æ‰æ˜¯å¶æ•°</p>

<p>å½“ <strong>n=3k</strong> ï¼Œæ—¶ï¼Œè‹¥ k æ˜¯å¥‡æ•°ï¼Œåˆ™ <strong>lowbit(F[n])=2</strong> ï¼Œå¦åˆ™  <strong>lowbit(F[n])=lowbit(4k)</strong></p>

<p>çŸ©é˜µä¹˜æ³•æ±‚â¼€ä¸€ä¸‹ F çš„å‰ç¼€å’Œ</p>

<h2 id="d-äºŒæ¬¡å‡½æ•°">D äºŒæ¬¡å‡½æ•°</h2>

<p>å¯¹äºŒæ¬¡å‡½æ•°è¿›è¡Œï¨ˆå¹³ç§»ï¼Œä½¿å¾— 0&lt;=a&lt;=1</p>
<ol>
  <li>è®¨è®º1ï¼ša å…¨æ˜¯ 0</li>
  <li>è®¨è®º2ï¼šå­˜åœ¨ä¸¤ä¸ª aï¼Œâ¼€ä¸€ä¸ªæ˜¯ 0ï¼Œâ¼€ä¸€ä¸ªæ˜¯ 1</li>
  <li>è®¨è®º3ï¼ša å…¨æ˜¯ 1</li>
</ol>

<h2 id="e-çº¿æ€§æ¢æŸ¥æ³•">E çº¿æ€§æ¢æŸ¥æ³•</h2>

<p>div2 å»ºå›¾å†æ‹“æ‰‘æ’åºï¼Œä¸´æ—¶å­¦äº†æ‹“æ‰‘æ’åºï¼Œä½†æ˜¯å»ºå›¾æ²¡æœ‰å»ºå¯¹ï¼Œçœ‹äº†é¢˜è§£åï¼Œç”¨äº†æ–°çš„å»ºå›¾æ–¹æ³•ï¼Œç„¶è€Œã€‚ã€‚ã€‚ã€‚ã€‚</p>

<p>waäº†äº”é¡µ</p>

<p>æˆ‘ä»¥ä¸ºæˆ‘å»ºå›¾æ²¡å»ºå¯¹ï¼Œæäº†åŠå¤©è¿˜æ˜¯waï¼Œæˆ‘åˆä»¥ä¸ºæˆ‘æ‹“æ‰‘æ’åºæ²¡å†™å¯¹ï¼Œç»“æœè¿˜æ˜¯waã€‚ã€‚ã€‚</p>

<p>æœ€åã€‚ã€‚ã€‚</p>

<p>æˆ‘æŠŠæ•°ç»„å¤§å°æ”¹äº†ä¸€ä¸‹ï¼Œä»¤ <strong>N=1005</strong> ï¼Œé‚»æ¥è¡¨çš„å¤§å°ä¸º <strong>NÃ—N</strong> ï¼Œç«Ÿç„¶è¿‡äº†ã€‚ã€‚</p>

<p>è¿‡äº†ã€‚</p>

<p>è¿‡äº†</p>

<p>ï¼ˆå·²è‡ªé—­</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;bits/stdc++.h&gt;
#define ll long long
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">N</span><span class="o">=</span><span class="mi">1010</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="mi">998244353</span><span class="p">;</span><span class="c1">//N=100005æ—¶waäº†äº”é¡µ</span>
<span class="kt">int</span> <span class="n">Next</span><span class="p">[</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">},</span><span class="n">ver</span><span class="p">[</span><span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="p">],</span><span class="n">tot</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">tot</span><span class="o">++</span><span class="p">;</span>
    <span class="n">ver</span><span class="p">[</span><span class="n">tot</span><span class="p">]</span><span class="o">=</span><span class="n">y</span><span class="p">;</span>
    <span class="n">Next</span><span class="p">[</span><span class="n">tot</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
    <span class="n">head</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">tot</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">struct</span> <span class="nc">node</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">p</span><span class="p">;</span>
    <span class="n">ll</span> <span class="n">vv</span><span class="p">;</span>
    <span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span> <span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">node</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="k">const</span> <span class="n">node</span> <span class="o">&amp;</span><span class="n">m</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="n">n</span><span class="p">.</span><span class="n">vv</span><span class="o">&gt;</span><span class="n">m</span><span class="p">.</span><span class="n">vv</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="n">ll</span> <span class="n">in</span><span class="p">[</span><span class="n">N</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">};</span>
<span class="n">ll</span> <span class="n">ans</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="p">;</span>
    <span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">node</span><span class="o">&gt;</span> <span class="n">Q</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">h</span><span class="o">=</span><span class="p">(</span><span class="n">ll</span><span class="p">)</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="n">h</span><span class="o">==</span><span class="n">i</span><span class="p">){</span>
            <span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">({</span><span class="n">i</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]});</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="n">h</span><span class="o">&lt;</span><span class="n">i</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&gt;=</span><span class="n">h</span><span class="p">;</span><span class="n">j</span><span class="o">--</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
                <span class="n">in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">h</span><span class="o">&gt;</span><span class="n">i</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
                <span class="n">in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">h</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">add</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
                <span class="n">in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">Q</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span>
    <span class="p">{</span>
        <span class="n">node</span> <span class="n">c</span><span class="o">=</span><span class="n">Q</span><span class="p">.</span><span class="n">top</span><span class="p">();</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">=</span><span class="n">c</span><span class="p">.</span><span class="n">vv</span><span class="p">;</span>
        <span class="n">Q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="n">t</span><span class="o">++</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="n">c</span><span class="p">.</span><span class="n">p</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">x</span><span class="p">];</span><span class="n">i</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="n">Next</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">y</span><span class="o">=</span><span class="n">ver</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="n">in</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">--</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">in</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">){</span>
                <span class="n">node</span> <span class="n">d</span><span class="p">;</span>
                <span class="n">d</span><span class="p">.</span><span class="n">p</span><span class="o">=</span><span class="n">y</span><span class="p">;</span><span class="n">d</span><span class="p">.</span><span class="n">vv</span><span class="o">=</span><span class="n">a</span><span class="p">[</span><span class="n">y</span><span class="p">];</span>
                <span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">d</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="sc">' '</span><span class="o">&lt;&lt;</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="f-é€†åºå¯¹">F é€†åºå¯¹ï¼</h2>

<p>ä¸Šåˆçš„ div1 è®²è¯¾çš„è¯¾å ‚æ£€æµ‹
\(a^{S}&gt;b^{S}\) çš„æ¡ä»¶æ˜¯ï¼Œè®¾ i æ˜¯ \(a^{b}\) çš„æœ€é«˜ä½ï¼Œ<strong>a</strong> çš„ç¬¬ <strong>i</strong> ä½è¦ ä¸ <strong>b</strong> çš„ç¬¬ <strong>i</strong> ä½ç›¸åŒ
æš´ï¨†åŠ›ï¦Šæ˜¯ <strong>n^2</strong> æšä¸¾æ‰€æœ‰å¯¹ï¼Œæœ€åå¯¹æ¯ä½ç»Ÿè®¡â¼€ä¸€ä¸‹ç­”æ¡ˆ
æŠŠæš´ï¨†åŠ›ï¦Šæ¢æˆåˆ†æ²»å¯ä»¥å˜æˆ <strong>nlogn</strong></p>

<h2 id="g-æŠ¢çº¢åŒ…æœºå™¨äºº">G æŠ¢çº¢åŒ…æœºå™¨äºº</h2>

<p>æ¯ä¸ªäººéƒ½å¯èƒ½æ˜¯æœºå™¨äººï¼Œæ¯ä¸ªæœºå™¨äººå‰çš„äººéƒ½æ˜¯æœºå™¨äººã€‚</p>

<p>è¿™ä¸å°±æ˜¯å¼ å›¾å—ï¼Œå»ºå›¾ï¼Œæšä¸¾æ¯ä¸ªç‚¹ï¼Œæ·±æœnæ¬¡ï¼Œæå®šã€‚</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;bits/stdc++.h&gt;
#define ll long long
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="mi">100005</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="mi">998244353</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">a</span><span class="p">[</span><span class="mi">105</span><span class="p">][</span><span class="mi">105</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">v</span><span class="p">[</span><span class="mi">105</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">Next</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">N</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">},</span><span class="n">ver</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">tot</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">y</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">tot</span><span class="o">++</span><span class="p">;</span>
    <span class="n">ver</span><span class="p">[</span><span class="n">tot</span><span class="p">]</span><span class="o">=</span><span class="n">y</span><span class="p">;</span>
    <span class="n">Next</span><span class="p">[</span><span class="n">tot</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
    <span class="n">head</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">tot</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">h</span><span class="p">[</span><span class="mi">105</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">p</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">p</span><span class="p">];</span><span class="n">i</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="n">Next</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="p">{</span>
        <span class="kt">int</span> <span class="n">y</span><span class="o">=</span><span class="n">ver</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">ans</span><span class="o">++</span><span class="p">;</span>
        <span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">dfs</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">;</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="n">m</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="n">j</span><span class="o">++</span><span class="p">){</span>
            <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span><span class="n">k</span><span class="o">&lt;=</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="n">k</span><span class="o">++</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">minn</span><span class="o">=</span><span class="mf">1e9</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">ans</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">memset</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">v</span><span class="p">));</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">dfs</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
        <span class="n">minn</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="n">minn</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">minn</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="h-åŒæ„">H åŒæ„</h2>

<p>å–è¡¥å›¾ï¼Œæ¯ä¸ªç‚¹åº¦æ•°å˜æˆ 2ï¼Œäºæ˜¯å›¾å°±æ˜¯è‹¥â¼²å¹²ä¸ªâ¼¤å¤§äºç­‰äº 3 çš„ç¯æ„æˆçš„ï¼Œç­”æ¡ˆç›¸å½“äº <strong>n</strong> çš„æ•´æ•°åˆ’åˆ†</p>

<p>å¯ä»¥ç”¨ä¸€ä¸ª <strong>n^1.5</strong> çš„ <strong>dp</strong> è¿‡æ‰</p>

<h2 id="i-é›†åˆ">I é›†åˆ</h2>

<p>å‡è®¾ <strong>T</strong> åˆ†æˆäº†ï¦º \(A+B\) ï¼Œè®¾ <strong>A,B</strong> çš„ç”Ÿæˆå‡½æ•°åˆ†åˆ«ä¸º\(a(x),b(x)\)</p>

<p>é‚£ä¹ˆ\(f(A)+f(B)=a(x)^{3}+b(x)^{3}\)çš„ \(x^{n},x^{2n},x^{3n}\) çš„ç³»æ•°ä¹‹å’Œ</p>

\[a(x)^{3}+b(x)^{3}=(a(x)+b(x))(a(x)^{2}-a(x)b(x)+b(x)^{2})\]

<p>\(a(x)+b(x)\)æ˜¯å…¨é›†ï¼Œå¯¹äºå³è¾¹å¤šé¡¹å¼çš„ä»»æ„â¼€ä¸€ä¸ªç³»æ•°ï¼Œ\(a(x)+b(x)\) åªå­˜åœ¨ä¸€ä¸ª \({x}^{i}\) å’Œä»–ä¹˜èµ·æ¥åæ˜¯ <strong>n</strong> çš„å€æ•°</p>

<table>
  <tbody>
    <tr>
      <td>æ‰€ä»¥ $$f(A)+f(B)=</td>
      <td>A</td>
      <td>^{2}-</td>
      <td>A</td>
      <td>(n-</td>
      <td>A</td>
      <td>)+(n-</td>
      <td>A</td>
      <td>)^{2}$$</td>
    </tr>
  </tbody>
</table>

<h2 id="j-å¼ºå£®çš„æ’åˆ—">J å¼ºå£®çš„æ’åˆ—</h2>

<p>è®¾ç­”æ¡ˆæ˜¯ <strong>f(n)</strong></p>

<p>è€ƒè™‘æœ€â¼¤å¤§çš„æ•°çš„ä½ç½®æ˜¯ <strong>i</strong>ï¼Œåˆ™å˜æˆä¸€ä¸ªé•¿åº¦ä¸º <strong>i-1</strong> çš„æ•°åˆ—ï¦œå’Œ ä¸€ä¸ªé•¿åº¦ä¸º <strong>n-i</strong> çš„æ•°åˆ—ï¦œ</p>

<p>æ‰€ä»¥ <strong>f(n)=sum(f(i)f(n-i-1))/n</strong></p>

<p>æ‰€ä»¥ <strong>f(x)â€™=f(x)^2+1</strong></p>

<p>è§£å¾— <strong>f(x)=tan(x)</strong></p>
:ET