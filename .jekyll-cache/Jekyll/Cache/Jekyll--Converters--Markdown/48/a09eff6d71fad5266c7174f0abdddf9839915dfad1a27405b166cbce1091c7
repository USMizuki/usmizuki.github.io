I"¥b<p>å‡è®¾_G_(<em>V</em>,<em>E</em>) æ˜¯ä¸€ä¸ªæœ‰é™çš„<a href="https://baike.baidu.com/item/%E6%9C%89%E5%90%91%E5%9B%BE">æœ‰å‘å›¾</a>ï¼Œå®ƒçš„æ¯æ¡è¾¹(u,v)âˆˆEéƒ½æœ‰ä¸€ä¸ªéè´Ÿå€¼å®æ•°çš„å®¹é‡_c_(<em>u</em>,<em>v</em>) ã€‚å¦‚æœ(u,v)ä¸å±äºEï¼Œæˆ‘ä»¬å‡è®¾_c_(<em>u</em>,<em>v</em>) = 0 ã€‚æˆ‘ä»¬åŒºåˆ«ä¸¤ä¸ªé¡¶ç‚¹ï¼šä¸€ä¸ª<a href="https://baike.baidu.com/item/%E6%BA%90%E7%82%B9">æºç‚¹</a><em>s_å’Œä¸€ä¸ªæ±‡ç‚¹_t</em>ã€‚ä¸€é“ç½‘ç»œæµæ˜¯ä¸€ä¸ªå¯¹äºæ‰€æœ‰ç»“ç‚¹_u_å’Œ_v_éƒ½æœ‰ä»¥ä¸‹ç‰¹æ€§çš„<a href="https://baike.baidu.com/item/%E5%AE%9E%E6%95%B0">å®æ•°</a>å‡½æ•°f:VÃ—Vâ†’R</p>

<p><strong>å®¹é‡é™åˆ¶ (Capacity Constraints)</strong>:</p>

<p>f(u,v)â‰¤c(u,v)ä¸€æ¡è¾¹çš„æµä¸èƒ½è¶…è¿‡å®ƒçš„å®¹é‡ã€‚</p>

<p><strong>æ–œå¯¹ç§° (Skew Symmetry)</strong>:</p>

<p>f(u,v)=-f(v,u)ç”±_u_åˆ°_v_çš„å‡€æµå¿…é¡»æ˜¯ç”±_v_åˆ°_u_çš„å‡€æµçš„ç›¸åï¼ˆå‚è€ƒä¾‹å­ï¼‰ã€‚ï¼ˆæ—¢ç„¶è¦çœ‹ç½‘ç»œæµï¼Œè¿™æ˜¯ä¸€å®šè¦çŸ¥é“çš„ï¼‰</p>

<p><strong>æµå®ˆæ’ (Flow Conservation)</strong>:</p>

<p>é™¤é_u_=<em>s_æˆ–_u</em>=<em>t</em>ï¼Œå¦åˆ™Î£ï¼ˆwâˆˆVï¼‰f(u,w)=0 ä¸€ç»“ç‚¹çš„å‡€æµæ˜¯é›¶ï¼Œé™¤äº†â€œåˆ¶é€ â€æµçš„æºç‚¹å’Œâ€œæ¶ˆè€—â€æµçš„æ±‡ç‚¹ã€‚</p>

<p>æ³¨æ„_f_(<em>u</em>,<em>v</em>) æ˜¯ç”±_u_åˆ°_v_çš„_å‡€_æµã€‚å¦‚æœè¯¥å›¾ä»£è¡¨ä¸€ä¸ªå®è´¨çš„ç½‘ç»œï¼Œç”±_u_åˆ°_v_æœ‰ 4 å•ä½çš„å®é™…æµåŠç”±_v_åˆ°_u_æœ‰ 3 å•ä½çš„å®é™…æµï¼Œé‚£ä¹ˆ_f_(<em>u</em>,<em>v</em>) = 1 åŠ_f_(<em>v</em>,<em>u</em>) = âˆ’ 1ã€‚</p>

<p>è¾¹çš„<strong>å‰©ä½™å®¹é‡ (Residual Capacity)</strong>æ˜¯_cf_(<em>u</em>,<em>v</em>) =<em>c</em>(<em>u</em>,<em>v</em>)âˆ’<em>f</em>(<em>u</em>,<em>v</em>)ã€‚è¿™å®šä¹‰äº†ä»¥_Gf_(<em>V</em>,<em>Ef</em>)è¡¨ç¤ºçš„<strong>å‰©ä½™ç½‘ç»œ (Residual Network)</strong>ï¼Œå®ƒæ˜¾ç¤ºå¯ç”¨çš„å®¹é‡çš„å¤šå°‘ã€‚ç•™æ„å°±ç®—åœ¨åŸç½‘ç»œä¸­ç”±_u_åˆ°_v_æ²¡æœ‰è¾¹ï¼Œåœ¨å‰©ä½™ç½‘ç»œä¹ƒå¯èƒ½æœ‰ç”±_u_åˆ°_v_çš„è¾¹ã€‚å› ä¸ºç›¸åæ–¹å‘çš„æµæŠµæ¶ˆï¼Œå‡å°‘ç”±våˆ°uçš„æµç­‰äºå¢åŠ ç”±_u_åˆ°_v_çš„æµã€‚<strong>æ‰©å¼ è·¯å¾„ (Augmenting Path)</strong>æ˜¯ä¸€æ¡è·¯å¾„ (u1,u2â€¦uk)ï¼Œè€Œ_u_1 =<em>s</em>ã€<em>uk</em>=<em>t_åŠ_cf</em>(<em>ui</em>,<em>ui</em>+ 1) &gt; 0ï¼Œè¿™è¡¨ç¤ºæ²¿è¿™æ¡è·¯å¾„ä¼ é€æ›´å¤šæµæ˜¯å¯èƒ½çš„ã€‚</p>

<blockquote>
  <p>ä»¥ä¸Šæ‘˜è‡ªç™¾åº¦ç™¾ç§‘</p>
</blockquote>

<p>ä¸‹é¢æ±‚æœ€å¤§æµçš„ä¸¤ä¸ªç®—æ³•åŸºç¡€æ€è·¯éƒ½ä¸€æ ·ï¼Œå°±æ˜¯æ±‚ä¸æ–­å¢å¹¿è·¯ã€‚å¢å¹¿è·¯æ˜¯ä¸€æ¡ä»såˆ°tçš„è·¯å¾„ï¼Œä¸”ä¸Šé¢çš„æ¯ä¸€æ¡è¾¹çš„å‰©ä½™å®¹é‡å¤§äº0ã€‚æ¯æ±‚å‡ºä¸€æ¡å¢å¹¿è·¯åŠå…¶æœ€å°æµé‡éƒ½è¦åœ¨è¿™æ¡è·¯å¾„ä¸Šæ›´æ–°å‰©ä½™æµé‡ï¼Œå¹¶å°†æœ€å°æµé‡åŠ åˆ°æœ€å¤§æµä¸­ã€‚</p>

<p>å°†æ¯ä¸€æ¡è¾¹çš„åå‘è¾¹ä¹Ÿè¿èµ·æ¥ï¼Œå› ä¸ºæ–œå¯¹ç§°æ€§ï¼Œæ‰€ä»¥æ¯æ¬¡æ›´æ–°æ—¶ï¼Œé™¤äº†åœ¨è¾¹ä¸Šå‡å»å¢å¹¿è·¯çš„æœ€å°æµé‡ï¼Œè¿˜è¦åœ¨åå‘è¾¹ä¸ŠåŠ ä¸Šæœ€å°æµé‡ã€‚</p>

<p>è‡³äºä¸ºä»€ä¹ˆæ˜¯å¯¹çš„ã€‚ã€‚ã€‚æˆ‘è¿˜éœ€è¦ä¸€æ®µæ—¶é—´çš„æ²‰æ·€æ¥ç†è§£ã€‚ã€‚</p>

<p><br /><br /></p>

<h2 id="edmonds-karp">Edmonds-Karp</h2>

<p>ç›´æ¥åœ¨ä¸€å¼ å›¾ä¸Šä¸æ–­å¯»æ‰¾å¢å¹¿è·¯ï¼Œç„¶åä¸æ–­æ›´æ–°ã€‚ã€‚</p>

<blockquote>
  <p>O(nm^2)
1e2 ~ 1e3</p>
</blockquote>

<p><a href="https://vjudge.net/problem/POJ-1273">POJ - 1273 Drainage Ditches </a></p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">head</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">ver</span><span class="p">[</span><span class="n">N</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">N</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span><span class="n">Next</span><span class="p">[</span><span class="n">N</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span><span class="n">tot</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">y</span><span class="p">,</span><span class="kt">int</span> <span class="n">w</span><span class="p">){</span>
    <span class="n">ver</span><span class="p">[</span><span class="o">++</span><span class="n">tot</span><span class="p">]</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">edge</span><span class="p">[</span><span class="n">tot</span><span class="p">]</span><span class="o">=</span><span class="n">w</span><span class="p">;</span>
    <span class="n">Next</span><span class="p">[</span><span class="n">tot</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">tot</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">maxflow</span><span class="p">,</span><span class="n">v</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">incf</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">pre</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="kt">bool</span> <span class="nf">bfs</span><span class="p">(){</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">v</span><span class="p">));</span>
    <span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">Q</span><span class="p">;</span>
    <span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="n">v</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">incf</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="n">inf</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">Q</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
        <span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="n">Q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span><span class="n">Q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">x</span><span class="p">];</span><span class="n">i</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="n">Next</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
            <span class="kt">int</span> <span class="n">y</span><span class="o">=</span><span class="n">ver</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">||</span><span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
            <span class="n">incf</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">incf</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
            <span class="n">pre</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
            <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="n">t</span><span class="p">)</span><span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">update</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="n">t</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="o">!=</span><span class="n">s</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">pre</span><span class="p">[</span><span class="n">x</span><span class="p">];</span>
        <span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-=</span><span class="n">incf</span><span class="p">[</span><span class="n">t</span><span class="p">];</span>
        <span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="o">^</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">incf</span><span class="p">[</span><span class="n">t</span><span class="p">];</span>
        <span class="n">x</span><span class="o">=</span><span class="n">ver</span><span class="p">[</span><span class="n">i</span><span class="o">^</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="n">maxflow</span><span class="o">+=</span><span class="n">incf</span><span class="p">[</span><span class="n">t</span><span class="p">];</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">resetMaxflow</span><span class="p">(){</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">head</span><span class="p">));</span>
    <span class="n">tot</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">maxflow</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">m</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="p">){</span>
        <span class="n">resetMaxflow</span><span class="p">();</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">n</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">;</span>
            <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="n">y</span><span class="o">&gt;&gt;</span><span class="n">z</span><span class="p">;</span>
            <span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">),</span><span class="n">add</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">while</span><span class="p">(</span><span class="n">bfs</span><span class="p">())</span><span class="n">update</span><span class="p">();</span>
        <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">maxflow</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p><br /><br /></p>

<h2 id="dinic">Dinic</h2>

<p>æ¯æ¬¡éƒ½éå†ä¸€æ•´å¼ å›¾æ˜¾ç„¶æ˜¯å¯ä»¥ç»§ç»­ä¼˜åŒ–çš„ã€‚</p>

<p>ä¸æ–­æ±‚å‡ºåˆ†å±‚å›¾ï¼Œé€šè¿‡dfsæ±‚å¢å¹¿è·¯å¹¶æ›´æ–°ã€‚</p>

<blockquote>
  <p>O(nm^2)
1e3 ~ 1e4</p>
</blockquote>

<p><a href="https://www.luogu.org/problem/P3376">P3376 ã€æ¨¡æ¿ã€‘ç½‘ç»œæœ€å¤§æµ</a></p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">head</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">ver</span><span class="p">[</span><span class="n">N</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span><span class="n">edge</span><span class="p">[</span><span class="n">N</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span><span class="n">Next</span><span class="p">[</span><span class="n">N</span><span class="o">*</span><span class="mi">2</span><span class="p">],</span><span class="n">tot</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">y</span><span class="p">,</span><span class="kt">int</span> <span class="n">w</span><span class="p">){</span>
    <span class="n">ver</span><span class="p">[</span><span class="o">++</span><span class="n">tot</span><span class="p">]</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="n">edge</span><span class="p">[</span><span class="n">tot</span><span class="p">]</span><span class="o">=</span><span class="n">w</span><span class="p">;</span>
    <span class="n">Next</span><span class="p">[</span><span class="n">tot</span><span class="p">]</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">x</span><span class="p">],</span><span class="n">head</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">=</span><span class="n">tot</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">maxflow</span><span class="p">,</span><span class="n">d</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="kt">bool</span> <span class="nf">bfs</span><span class="p">(){</span>
    <span class="n">queue</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">Q</span><span class="p">;</span>
    <span class="n">memset</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">d</span><span class="p">));</span>
    <span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">Q</span><span class="p">.</span><span class="n">empty</span><span class="p">()){</span>
        <span class="kt">int</span> <span class="n">x</span><span class="o">=</span><span class="n">Q</span><span class="p">.</span><span class="n">front</span><span class="p">();</span><span class="n">Q</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">x</span><span class="p">];</span><span class="n">i</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="n">Next</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
            <span class="kt">int</span> <span class="n">y</span><span class="o">=</span><span class="n">ver</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">||</span><span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">])</span><span class="k">continue</span><span class="p">;</span>
            <span class="n">Q</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">y</span><span class="o">==</span><span class="n">t</span><span class="p">)</span><span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">dinic</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">flow</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="n">t</span><span class="p">)</span><span class="k">return</span> <span class="n">flow</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">rest</span><span class="o">=</span><span class="n">flow</span><span class="p">,</span><span class="n">k</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">head</span><span class="p">[</span><span class="n">x</span><span class="p">];</span><span class="n">i</span><span class="o">&amp;&amp;</span><span class="n">rest</span><span class="p">;</span><span class="n">i</span><span class="o">=</span><span class="n">Next</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
        <span class="kt">int</span> <span class="n">y</span><span class="o">=</span><span class="n">ver</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">||</span><span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">!=</span><span class="n">d</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="k">continue</span><span class="p">;</span>
        <span class="n">k</span><span class="o">=</span><span class="n">dinic</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">min</span><span class="p">(</span><span class="n">rest</span><span class="p">,</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">]));</span>
        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">k</span><span class="p">)</span><span class="n">d</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-=</span><span class="n">k</span><span class="p">,</span><span class="n">edge</span><span class="p">[</span><span class="n">i</span><span class="o">^</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">k</span><span class="p">;</span>
        <span class="n">rest</span><span class="o">-=</span><span class="n">k</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">flow</span><span class="o">-</span><span class="n">rest</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ios</span><span class="o">::</span><span class="n">sync_with_stdio</span><span class="p">(</span><span class="nb">false</span><span class="p">);</span>
    <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="o">&gt;&gt;</span><span class="n">m</span><span class="o">&gt;&gt;</span><span class="n">s</span><span class="o">&gt;&gt;</span><span class="n">t</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">;</span>
        <span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">x</span><span class="o">&gt;&gt;</span><span class="n">y</span><span class="o">&gt;&gt;</span><span class="n">z</span><span class="p">;</span>
        <span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">),</span><span class="n">add</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">flow</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">bfs</span><span class="p">())</span>
        <span class="k">while</span><span class="p">(</span><span class="n">flow</span><span class="o">=</span><span class="n">dinic</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">inf</span><span class="p">))</span>
            <span class="n">maxflow</span><span class="o">+=</span><span class="n">flow</span><span class="p">;</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">maxflow</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
:ET